<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>üîå Live IoT Dashboard</title>
  <script src="https://cdn.jsdelivr.net/npm/mqtt/dist/mqtt.min.js"></script>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <style>
    body { font-family: sans-serif; margin: 0; padding: 0; background: #eef2f7; }
    header { background: #003366; color: white; padding: 1em; text-align: center; font-size: 1.5em; }
    .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 1em; padding: 1em; }
    .card {
      background: white; border-radius: 10px; padding: 1em; box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }
    #map { height: 300px; }
    .gpio-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 0.5em; }
    .switch { display: flex; align-items: center; justify-content: space-between; }
    .slider { width: 100%; }
    .label { font-size: 0.9em; margin-top: 0.2em; text-align: center; }
  </style>
  <script src="https://unpkg.com/mqtt/dist/mqtt.min.js"></script>
</head>
<body>

  <h1>üì° Realtime GNSS + I/O Dashboard</h1>

  <!-- Add elements to show or interact with MQTT data -->
  <p><strong>Status:</strong> <span id="mqtt-status">Not Connected</span></p>

  <!-- ‚úÖ Your MQTT logic script goes here -->
  <script>
    // Connect to the Raspberry Pi's MQTT broker via WebSocket
    const client = mqtt.connect('ws://192.168.137.112:9001'); // Replace with your Pi IP

    client.on('connect', () => {
      console.log("‚úÖ Connected to MQTT broker");
      document.getElementById('mqtt-status').innerText = "Connected";

      // Subscribe to test topic
      client.subscribe('test/topic', (err) => {
        if (!err) {
          console.log("Subscribed to test/topic");
        }
      });

      // Publish a message for testing
      client.publish('test/topic', 'Hello from browser!');
    });

    client.on('message', (topic, message) => {
      console.log(`üì© ${topic}: ${message.toString()}`);
    });

    client.on('error', (err) => {
      console.error("‚ùå MQTT Error:", err);
      document.getElementById('mqtt-status').innerText = "Connection Failed";
    });
  </script>

</body>
</html>
